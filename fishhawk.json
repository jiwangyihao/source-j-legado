[
  {
    "bookSourceComment": "é…·å®‰ @å‰ç‹ä¹‰æ˜Š\nGitHubï¼šhttps://github.com/jiwangyihao/source-j-legado\n\n# å…³äºè®¸å¯çš„é¢å¤–å£°æ˜ï¼ˆåœ¨çº¿ç‰ˆæœ¬å‚è§ GitHubï¼Œä»¥åœ¨çº¿ç‰ˆæœ¬ä¸ºå‡†ï¼‰\n\n- å½“è®¸å¯è¯ä¸æœ¬å£°æ˜å†²çªæ—¶ï¼Œä»¥æœ¬å£°æ˜ä¸ºå‡†ï¼›\n- å¯¹äºæœ¬ä»“åº“ä¸­çš„ä»»æ„ä»£ç ç‰‡æ®µï¼šæŒ‰ç…§ `MPL 2.0` ä¸­æœ‰å…³çº¦å®šæ‰§è¡Œï¼›\n- å¯¹äºæœ¬ä»“åº“ä¸­çš„æŸä¸€å®Œæ•´ä¹¦æºçš„è½¬è½½æˆ–äºŒæ¬¡å¼€å‘ï¼Œéœ€æ»¡è¶³ä»¥ä¸‹å…¨éƒ¨æ¡ä»¶ï¼š\n  - åœ¨[æœ¬ä»“åº“](https://github.com/jiwangyihao/source-j-legado)çš„ `issue` ä¸­æå‡ºè¯·æ±‚å¹¶å…·ä½“è¯´æ˜è½¬è½½åœ°å€ã€äºŒæ¬¡å¼€å‘åçš„ä¹¦æºå¼€æºåœ°å€ä»¥åŠå…¶ä»–å¿…è¦ä¿¡æ¯ï¼›\n  - ç­‰å¾…åŸä½œè€…ï¼ˆå³æœ¬ä»“åº“çš„åˆå§‹æ‰€æœ‰è€…å’Œåˆå§‹ä»£ç è´¡çŒ®è€… [@jiwangyihao](https://github.com/jiwangyihao)ï¼‰æŸ¥çœ‹å¹¶é€šè¿‡ `issue` æˆ–ä¾æ®åŸä½œè€…è¦æ±‚æ›´æ”¹è½¬è½½æ–¹å¼æˆ–è¡¥å……æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚\n  - è€ƒè™‘åˆ°æœ¬é¡¹ç›®å¼ƒå‘çš„å¯èƒ½ï¼Œæ–° `issue` å¼€å¯åè¶…è¿‡ 20 ä¸ªå·¥ä½œæ—¥åŸä½œè€…æ²¡æœ‰å›å¤æˆ–è€…åŸä½œè€…å›å¤è¦æ±‚æ›´æ”¹çš„ `issue` åœ¨æ›´æ”¹åè¶…è¿‡ 20 ä¸ªå·¥ä½œæ—¥åŸä½œè€…æ²¡æœ‰å›å¤å³è§†ä¸ºåŸä½œè€…é€šè¿‡è¯¥ `issue`ï¼š\n    - æ­¤å¤„çš„ `issue` ä»…åŒ…æ‹¬åœ¨[æœ¬ä»“åº“](https://github.com/jiwangyihao/source-j-legado)å¼€å¯çš„ï¼Œå¤„äºã€Œå¼€å¯çŠ¶æ€ã€çš„ issueã€‚ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œè¯·ä¸è¦åœ¨å·²ç»å…³é—­çš„ issue ä¸­å›å¤ï¼‰ã€‚\n    - å¯¹äºæ­¤ç§æ–¹å¼é€šè¿‡çš„ issueï¼Œè½¬è½½/äºŒæ¬¡å¼€å‘è€…ä»åº”å½“éµå®ˆæœ¬å£°æ˜ä¸­å·²ç»å†™æ˜çš„ç›¸å…³çº¦å®šã€‚\n  - ä¸å¾—ä¸Šä¼ è‡³æºä»“åº“æˆ–æ•´ç†è‡³`éè½»å°è¯´ä¸“ç”¨`çš„ä¹¦æºåˆé›†ä¸­å¹¶åº”å½“é¿å…å…¶ä»–äººå°†è½¬è½½/äºŒæ¬¡å¼€å‘ç‰ˆæœ¬ä¸Šä¼ è‡³æºä»“åº“æˆ–æ•´ç†è‡³`éè½»å°è¯´ä¸“ç”¨`çš„ä¹¦æºåˆé›†ä¸­ï¼š\n    - å…³äºè½»å°è¯´çš„å®šä¹‰çš„é¢å¤–è¯´æ˜ï¼šä¸åŒ…æ‹¬å›½å†…çš„åŸåˆ›ç½‘ç»œæ–‡å­¦ä½œå“ï¼ˆå¦‚ `SF è½»å°è¯´` ä¸­çš„åŸåˆ›è½»å°è¯´ä»¥åŠ`èµ·ç‚¹ä¸­æ–‡ç½‘`ä¸­æ ‡ç­¾åŒ…å«è½»å°è¯´çš„ä½œå“ï¼‰ã€‚\n    - è½»å°è¯´ä¸“ç”¨çš„å®šä¹‰ï¼šæœ‰ä¸”ä»…æœ‰æƒ³çœ‹è½»å°è¯´çš„äººå¯èƒ½ä¼šæ·»åŠ ã€‚\n  - å¿…é¡»åœ¨è½¬è½½/äºŒæ¬¡å¼€å‘åœ°å€çš„æ˜æ˜¾ä½ç½®å®Œæ•´åŒ…å«æœ¬å£°æ˜çš„å…¨éƒ¨å†…å®¹ã€‚\n  - å¿…é¡»ä¿ç•™æºæ³¨é‡Šä¸­åŸæœ‰çš„æ›´æ”¹è®°å½•ã€‚\n\n2024.4.10\né…·å®‰ @å‰ç‹ä¹‰æ˜Š\nå¤„ç†ç›®å½•ä¸­çš„å·å\nè§£å†³äº†ç« èŠ‚ä¸­çš„å¼•å·å¯¼è‡´åŠ è½½ç›®å½•å¤±è´¥çš„é—®é¢˜\n2024.5.7\né…·å®‰ @å‰ç‹ä¹‰æ˜Š\næ”¯æŒç™»å½•\næ”¯æŒç½‘ç«™é˜…è¯»å†å²\næ”¯æŒæ”¶è—ï¼ˆå¤šæ”¶è—å¤¹ï¼‰\næ–°å¢å‘ç°\n2024.5.31\né…·å®‰ @å‰ç‹ä¹‰æ˜Š\nä¿®æ­£ä¼˜å…ˆçº§åºåˆ—æ¨¡å¼ä¸‹æ„å¤–å¿½ç•¥åç»­ç¿»è¯‘æºçš„é—®é¢˜\n2024.6.21\né…·å®‰ @å‰ç‹ä¹‰æ˜Š\nè·Ÿè¿›æœ€æ–° API æ›´æ”¹\n2024.7.8\né…·å®‰ @å‰ç‹ä¹‰æ˜Š\nè·Ÿè¿›æºç«™å‘ç°æ›´æ”¹\n2024.7.23\né…·å®‰ @å‰ç‹ä¹‰æ˜Š\nè·Ÿè¿›æºç«™ç™»å½•æ›´æ”¹\n2024.8.10\né…·å®‰ @å‰ç‹ä¹‰æ˜Š\næ”¯æŒæ·»åŠ ç½‘å€\n2024.10.28\né…·å®‰ @å‰ç‹ä¹‰æ˜Š\næ”¯æŒã€ŒLordlyâ€¢é˜…è¯»ã€\næ”¯æŒåœ¨æ­£æ–‡ä¸­åŠ è½½å›¾ç‰‡\n2025.4.25\né…·å®‰ @å‰ç‹ä¹‰æ˜Š\nä¿®å¤å‘ç°é¡µåŠ è½½\nè°ƒæ•´ç›®å½•ç« èŠ‚åè§„åˆ™\n2025.9.5\né…·å®‰ @å‰ç‹ä¹‰æ˜Š\nè·Ÿè¿›åŸŸåæ›´æ”¹\nä¿®å¤å‘ç°\n@DarkTide\næ·»åŠ æ–‡åº“æœ¬æ”¯æŒ\nå‘ç°å¢åŠ æ–‡åº“åˆ†ç±»",
    "bookSourceGroup": "è½»å°è¯´,æœºç¿»",
    "bookSourceName": "è½»å°è¯´æœºç¿»ğŸ¤–",
    "bookSourceType": 0,
    "bookSourceUrl": "https://n.novelia.cc/",
    "bookUrlPattern": "https?://n.novelia.cc/(api/)?novel/\\w+/\\w+",
    "customOrder": 7,
    "enabled": true,
    "enabledCookieJar": true,
    "enabledExplore": true,
    "exploreUrl": "@js:\nresult=[\n  {\n    'title': '>> ä¸ªäººä¸­å¿ƒ <<',\n    'url': \"\",\n    'style':{\n      layout_flexGrow:1,\n      layout_flexBasisPercent:1\n    }\n  },\n  {\n    'title': \"é˜…è¯»å†å²\",\n    'url': `/api/user/read-history?page={{page-1}}&pageSize=30`,\n    'style':{\n      layout_flexGrow:2,\n      layout_flexBasisPercent:0.25\n    \t}\n  }\n]\nfavored = String(java.ajax(source.bookSourceUrl + \"/api/user/favored\"))\nif (favored.match(\"Tokenä¸åˆæ³•æˆ–è€…è¿‡æœŸ\")) {\n  result[0].title = '>> ä¸ªäººä¸­å¿ƒ | æœªç™»å½• <<'\n} else {\n  favored = JSON.parse(java.ajax(source.bookSourceUrl + \"/api/user/favored\")).favoredWeb\n  favored.forEach(favor => {\n    result.push({\n      'title': favor.title,\n      'url': `/api/user/favored-web/${favor.id}?page={{page-1}}&pageSize=30&query=&provider=kakuyomu%2Csyosetu%2Cnovelup%2Chameln%2Cpixiv%2Calphapolis&type=0&level=0&translate=0&sort=update`,\n      'style':{\n        layout_flexGrow:2,\n        layout_flexBasisPercent:0.25\n      \t}\n    })\n  })\n}\nresult.push({\n    'title': '> > æ–‡åº“å°è¯´ < <',\n    'url': null,\n    'style': {\n        layout_flexGrow: 1,\n        layout_flexBasisPercent: 1\n    }\n});\n[\"ä¸€èˆ¬å‘\", \"æˆäººå‘\", \"ä¸¥è‚ƒå‘\"].forEach((level, id) => {\n    result.push({\n        'title': level,\n        'url': `/api/wenku?page={{page - 1}}&pageSize=24&query=&level=${id + 1}`,\n        'style': {\n            layout_flexGrow: 1,\n            layout_flexBasisPercent: 0.2\n        }\n    });\n});\nString(java.ajax(`https://fastly.jsdelivr.net/gh/FishHawk/auto-novel@main/web/src/pages/MainLayout.vue, {\n  \"headers\": {\n    \"Authorization\": \"\"\n  }\n}`))\n.match(/label:.?'å°è¯´æ’è¡Œ'[^\\]]+]/gi)[0]\n.match(/renderLabel\\(.+\\)/gi)\n.forEach((menu,index)=>{\n  if (index!=1) {\n    title=menu.replace(/renderLabel\\('(.+)',.?'(.+)'\\)/gi, \"$1\")\n    href=menu.replace(/renderLabel\\('(.+)',.?'(.+)'\\)/gi, \"$2\")\n    result.push({\n      'title': `>> ${title} <<`,\n      'url': \"\",\n      'style':{\n        layout_flexGrow:1,\n        layout_flexBasisPercent:1\n      }\n    })\n    html = org.jsoup.Jsoup.parse(String(java.webView(null,source.bookSourceUrl + href.replace(/^\\//i,''),null)))\n    sorts = html.select(\".n-layout-scroll-container h1 + div.n-flex > .n-flex\")\n    sorts[0].select(\".n-flex > .n-flex > .n-flex > span\").forEach(tag => {\n      result.push({\n        'title': tag.text(),\n        'url': href.replace(/\\/(.+)\\/(.+)\\/(.+)/gi, \"$3\") != \"2\" ? `/api/novel/rank/${href.replace(/\\/(.+)\\/(.+)\\/(.+)/gi, \"$2\")}?type=${title.replace(/(.+)ï¼š(.+)/gi,\"$2\").replace(\"å¼‚ä¸–ç•Œè½¬ç§»/è½¬ç”Ÿ\", \"å¼‚ä¸–ç•Œè½¬ç”Ÿ/è½¬ç§»\")}&genre=${tag.text()}&range=æ€»è®¡&status=å…¨éƒ¨&page={{page-1}}` : `/api/novel/rank/${href.replace(/\\/(.+)\\/(.+)\\/(.+)/gi, \"$2\")}?type=${title.replace(/(.+)ï¼š(.+)/gi,\"$2\")}&range=${tag.text()}&status=å…¨éƒ¨&page={{page-1}}`,\n        'style':{\n          layout_flexGrow:2,\n          layout_flexBasisPercent:0.4\n        \t}\n      })\n    \t})\n  }\n})\nJSON.stringify(result)",
    "jsLib": "function getConfig() {\n  const { book, source, java } = this\n  const config = {\n  \t  language: \"ä¸­æ—¥\",\n  \t  translation: \"SGYB\",\n  \t  translationArr: []\n  \t}\n  \tconst languages = [\n  \t  \"æ—¥æ–‡\",\n    \"ä¸­æ–‡\",\n    \"ä¸­æ—¥\",\n    \"æ—¥ä¸­\"\n  ]\n  const translations = {\n  \t  B: \"baiduParagraphs\",\n  \t  Y: \"youdaoParagraphs\",\n  \t  G: \"gptParagraphs\",\n  \t  S: \"sakuraParagraphs\"\n  \t}\n  \tfunction applyTran(tranStr) {\n  \t  config.translation=tranStr\n  \t  if (tranStr===\"å¹¶åˆ—\") tranStr=\"SGYB\"\n  \t  let tranArr = []\n  \t  for (let i=0; i<tranStr.length; i++) {\n  \t  \t  tranArr.push(translations[tranStr.charAt(i)])\n  \t  \t}\n  \t  \tconfig.translationArr=tranArr\n  \t}\n  \tfunction applyLanguage(lang) {\n  \t  if (languages.includes(lang))\n  \t  \t  config.language=lang\n  \t}\n  applyTran(config.translation)\n  const sVar = String(source.getVariable()).replace(/\\s/gi, '').split('-')\n  if (sVar[0]) applyLanguage(sVar[0])\n  if (sVar[1]) applyTran(sVar[1])\n  const bVar = String(book.getVariable(\"custom\")).replace(/\\s/gi, '').split('-')\n  if (bVar[0]) applyLanguage(bVar[0])\n  if (bVar[1]) applyTran(bVar[1])\n  return config\n}",
    "lastUpdateTime": 1760189380805,
    "loginCheckJs": "if (/Tokenä¸åˆæ³•æˆ–è€…è¿‡æœŸ/.test(result.body()) && source.getLoginHeader()) {\n    eval(String(source.loginUrl));\n    login();\n    java.toast('Tokenå·²æ›´æ–°');\n    result = java.connect(result.url() + \",\" + JSON.stringify({\n        \"headers\": {\n            \"Authorization\": source.getLoginHeaderMap().get(\"Authorization\")\n        }\n    })\n    );\n}\nresult;",
    "loginUi": "[\n  {\n    \"name\": \"è´¦å·\",\n    \"type\": \"text\"\n  },\n  {\n    \"name\": \"å¯†ç \",\n    \"type\": \"password\"\n  }\n]",
    "loginUrl": "function login() {\n  let une = source.getLoginInfoMap().get(\"è´¦å·\")\n  let pwd = source.getLoginInfoMap().get(\"å¯†ç \")\n  if (une && pwd) {\n    let body = JSON.stringify({\n      username: une,\n      password: pwd,\n      app: \"n\"\n    })\n    let url = source.bookSourceUrl.replace(\"n.\", \"auth.\") + 'api/v1/auth/login'\n    let res = java.post(url, body, {\n      \"Content-Type\": \"application/json\"\n    })\n    if (res.body().match(/é”™è¯¯/gi)) {\n      throw(res.body())\n    }\n    //throw(String(res.body()))\n    //result = JSON.parse(res.body())\n    \n    let header = JSON.stringify({\n      \"Authorization\": \"Bearer \" + res.body()\n    })\n    source.putLoginHeader(header)\n  }\n}",
    "respondTime": 180000,
    "ruleBookInfo": {
      "author": "$.authors.*.name||$.authors",
      "coverUrl": "$.cover",
      "downloadUrls": "@js:JSON.parse(src).volumeJp.map(e => `${baseUrl}/file/${e.volumeId}?mode=zh-jp&translationsMode=priority&filename=zh-jp.Ysgyb.${e.volumeId}&translations=sakura&translations=gpt&translations=youdao&translations=baidu`);",
      "init": "@js:\nif (/\\/wenku\\//.test(book.bookUrl)) book.type = 128;\nif (!/api/g.test(book.bookUrl)) {\n  book.bookUrl=book.bookUrl.replace(\"novel\",\"api/novel\")\n  result=java.ajax(book.bookUrl)\n}\nresult=JSON.parse(result)\nresult.points+=' PT'\nresult.visited+=' æµè§ˆ'\nJSON.stringify(result)",
      "intro": "{{$.introduction}}\nå½“å‰è§„åˆ™ï¼šè¯­è¨€å±•ç°å½¢å¼-{{getConfig().language}}ï¼Œç¿»è¯‘ä¼˜å…ˆçº§-{{getConfig().translation}}ï¼ˆå¯åœ¨æºå˜é‡æˆ–ä¹¦ç±å˜é‡ä¸­ä¿®æ”¹ï¼Œè¯¦æƒ…å‚è€ƒå˜é‡è¯´æ˜ï¼‰\n\n{{$.titleJp}}\næ€»è®¡ï¼š{{$.total}} ç™¾åº¦ï¼š{{$.baidu}} æœ‰é“ï¼š{{$.youdao}} GPTï¼š{{$.gpt}} Sakuraï¼š{{$.sakura}}\n\n{{$.introductionZh}}\n\n{{$.introductionJp}}",
      "kind": "$.attentions&&$.type&&$.points&&$.visited&&$.keywords",
      "lastChapter": "{{$.toc[-1].titleZh||$.toc[-1].titleJp}}",
      "name": "$.titleZh",
      "wordCount": "$.totalCharacters"
    },
    "ruleContent": {
      "content": "@js:\nresult=JSON.parse(result)\nconst config=getConfig()\nconst resultList=[]\nfor (let ip = 0; ip < result.paragraphs.length; ip++) {\n  let p = result.paragraphs[ip]\n  if (/^<å›¾ç‰‡>http.+$/.test(p)) {\n    p = '<img src=\"'+p.replace(/^<å›¾ç‰‡>/i, \"\")+'\">'\n    resultList.push(p)\n    continue\n  }\n  function generateTran(i) {\n    const chars = {\n  \t    baiduParagraphs: \"áµ‡\",\n  \t    youdaoParagraphs: \"Ê¸\",\n  \t    gptParagraphs: \"áµ\",\n  \t    sakuraParagraphs: \"Ë¢\"\n    }\n    if (config.translation===\"å¹¶åˆ—\") {\n      const processed=[]\n      for (let ii = 0; ii < config.translationArr.length; ii++) {\n        let t = config.translationArr[ii]\n        if (result[t]) {\n          if (/^<å›¾ç‰‡>http.+$/.test(result[t][i])) {\n            let tmp = '<img src=\"'+result[t][i].replace(/^<å›¾ç‰‡>/i, \"\")+'\">'\n            if (!processed.includes(tmp))\n              processed.push(tmp)\n            \tcontinue\n          }\n          processed.push((result[t][i]!=\"\" ? chars[t] : \"\") + result[t][i].trim())\n          continue\n        }\n        processed.push(\"\")\n      }\n      return processed.join(\"\\n\")\n    } else {\n      for (let tt=0; tt<config.translationArr.length; tt++) {\n        let t=config.translationArr[tt]\n        if (result[t]) {\n          if (/^<å›¾ç‰‡>http.+$/.test(result[t][i])) {\n            let tmp = '<img src=\"'+result[t][i].replace(/^<å›¾ç‰‡>/i, \"\")+'\">'\n            return tmp\n          }\n          return (result[t][i]!=\"\" ? chars[t] : \"\") + result[t][i].trim()\n        }\n      }\n    }\n  \t}\n  switch (String(config.language)) {\n  \t  case \"æ—¥æ–‡\":\n  \t    resultList.push(p)\n  \t    break\n  \t  case \"ä¸­æ–‡\":\n  \t    resultList.push(generateTran(ip))\n  \t    break\n  \t  case \"ä¸­æ—¥\":\n  \t    resultList.push([generateTran(ip), p.trim()].join(\"\\n\"))\n  \t    break\n  \t  case \"æ—¥ä¸­\":\n  \t    resultList.push([p, generateTran(ip)].join(\"\\n\"))\n  \t    break\n  \t}\n}\nresultList.join(\"\\n\")"
    },
    "ruleExplore": {},
    "ruleSearch": {
      "bookList": "$.items",
      "bookUrl": "@js:\n/\\/wenku\\?/.test(baseUrl) ? `/api/wenku/{{$.id}}` : `/api/novel/{{$.providerId}}/{{$.novelId}}`;",
      "checkKeyWord": "é©¯å…½å¸ˆå°‘å¥³çš„é€ƒäº¡æ—¥è®°",
      "coverUrl": "$.cover",
      "intro": "{{$.titleJp}}\næ€»è®¡ï¼š{{$.total}} ç™¾åº¦ï¼š{{$.baidu}} æœ‰é“ï¼š{{$.youdao}} GPTï¼š{{$.gpt}} Sakuraï¼š{{$.sakura}}",
      "kind": "$.attentions&&$.type&&$.keywords",
      "lastChapter": "@js:\n`{{$.total}} - ` + new Date(parseInt({{$.updateAt}}) * 1000).toJSON().replace(/T|\\.\\d+Z/gi, ' ')",
      "name": "$.titleZh||$.titleJp"
    },
    "ruleToc": {
      "chapterList": "$.toc",
      "chapterName": "$.titleZh||$.titleJp",
      "chapterUrl": "@js:\nresult.chapterId ? `{{baseUrl}}/chapter/${result.chapterId}` : ''",
      "isVolume": "@js:\n!result.chapterId",
      "updateTime": "@js:\nresult.chapterId ? (`${result.titleJp} - ` + (result.createAt ? new Date(parseInt(result.createAt) * 1000).toJSON().replace(/T|\\.\\d+Z/gi, ' ') : 'æš‚æ— ')) : ''"
    },
    "searchUrl": "/api/novel?page={{page-1}}&pageSize=20&query={{key}}&provider=kakuyomu%2Csyosetu%2Cnovelup%2Chameln%2Cpixiv%2Calphapolis&level=0&type=0&translate=0&sort=0",
    "variableComment": "è®¾ç½®æ­£æ–‡è¯­è¨€å±•ç°å½¢å¼åŠç¿»è¯‘ä¼˜å…ˆçº§\nï¼é”™è¯¯çš„è®¾ç½®å¯èƒ½å¯¼è‡´ä¹¦æºå·¥ä½œä¸æ­£å¸¸\næ ¼å¼ï¼šè¯­è¨€å±•ç°å½¢å¼ - ç¿»è¯‘ä¼˜å…ˆçº§\n\nè¯­è¨€å±•ç°å½¢å¼ï¼š\n- æ—¥æ–‡\n- ä¸­æ–‡\n- ä¸­æ—¥\n- æ—¥ä¸­\nç¿»è¯‘ä¼˜å…ˆçº§ï¼š\n- å¹¶åˆ—ï¼ˆå±•ç¤ºæ‰€æœ‰å­˜åœ¨çš„ç¿»è¯‘ï¼‰\n- ä¼˜å…ˆçº§åºåˆ—ï¼Œå†™åœ¨å‰é¢çš„ä¼˜å…ˆé‡‡ç”¨ï¼ŒB-ç™¾åº¦ã€Y-æœ‰é“ã€G-GPTã€S-Sakuraï¼Œå¦‚ `SGYB`\n\nç¤ºä¾‹ï¼ˆé»˜è®¤å€¼ï¼‰ï¼šä¸­æ—¥ - SGYB\nç¤ºä¾‹ï¼šä¸­æ–‡ - å¹¶åˆ—",
    "weight": 0
  }
]
